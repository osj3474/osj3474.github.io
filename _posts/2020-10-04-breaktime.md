---
title: \[ë°ì´í„°\] ìƒˆë¡œìš´ í¬ë¡¤ë§ ë°©ë²•
categories:
   - data
---

<br>

# ìš”ì¦˜ì˜ ì¼ìƒ

2020ë…„ë„ í•˜ë°˜ê¸° ê³µì±„ ì‹œì¦Œì´ ë˜ë©´ì„œ,

- ìˆ˜ì—…&ê³¼ì œ
- ìì†Œì„œ ì“°ê¸°

ê°€ í•˜ë£¨ì˜ ì „ë¶€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì·¨ì—…ì„ ì¤€ë¹„í•˜ì‹œëŠ” ë¶„ë“¤ ëª¨ë‘ íŒŒì´íŒ… ã… ã…œ

<br>



# êµìˆ˜ë‹˜ì˜ ë…¸í¬

ì €ëŠ” êµìˆ˜ë‹˜ ë§ì€í¸ì— ìˆëŠ” í•™íšŒì‹¤ì—ì„œ ì£¼ë¡œ ê³µë¶€ë¥¼ í•©ë‹ˆë‹¤. ICTìœµí•© íŠ¹ë¡  ìˆ˜ì—… TAë¼ ì‹œí‚¤ì‹¤ ì¼ì´ ìˆìœ¼ë©´ ë°”ë¡œ í•˜ê³¤ í•©ë‹ˆë‹¤.

ì´ë²ˆì—ëŠ” ìˆ˜ì—… ë•Œ ì‚¬ìš©í•  ë°ì´í„°ë¥¼ ëª¨ì•„ë‹¬ë¼ê³  ë§ì”€í•´ ì£¼ì…¨ëŠ”ë°, í•´ë‹¹ ë°ì´í„°ëŠ” ì½”ë¡œë‚˜ ê´€ë ¨ ì¬ë‚œ ë¬¸ì ë°ì´í„°ì˜€ìŠµë‹ˆë‹¤.

ë§í¬ : http://www.safekorea.go.kr/idsiSFK/neo/sfk/cs/sfc/dis/disasterMsgList.jsp?emgPage=Y&menuSeq=679

ìš°ì„ , robots.txtë¡œ í¬ë¡¤ë§ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ í™•ì¸í•´ë´¤ëŠ”ë°, í™•ì¸ì´ ë˜ì§€ëŠ” ì•Šì•˜ìŠµë‹ˆë‹¤.

(ì›¹ì‚¬ì´íŠ¸ ìµœìƒìœ„ ê²½ë¡œì—ì„œ í™•ì¸í•˜ëŠ”ê±° ì•„ë‹Œê°€ìš”? ì•„ì‹œëŠ” ë¶„,,,)

<img src="https://user-images.githubusercontent.com/42775225/95009872-2312e500-0660-11eb-8834-eb44279f5cd8.png" alt="image" style="zoom:50%;" />

ì¼ë‹¨, ë‚˜ìœ ìš©ë„ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— í¬ë¡¤ë§ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤.

<br><br>

# ìƒˆë¡œìš´ í¬ë¡¤ë§ ë°©ë²•

ì›ë˜ë¼ë©´ URL ê¸°ë°˜ìœ¼ë¡œ í¬ë¡¤ë§ì´ ì•ˆ ë˜ëŠ”ê±´ ì—†ë‹¤ê³  ìƒê°í–ˆì—ˆëŠ”ë°, í•´ë‹¹ ì‚¬ì´íŠ¸ëŠ” URLì´ ì „í˜€ ë°”ë€Œì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

(ì´ ë•Œê¹Œì§€ëŠ”, 'í˜ì´ì§€ ì†ŒìŠ¤'ì— ì§ì ‘ì ìœ¼ë¡œ ì›í•˜ëŠ” textê°€ ì—†ë”ë¼ë„ textê°€ ìˆëŠ” URLì´ ì†ŒìŠ¤ ì•ˆì— ìˆê¸° ë§ˆë ¨ì´ì—ˆìŠµë‹ˆë‹¤.)

![image](https://user-images.githubusercontent.com/42775225/95010029-47bb8c80-0661-11eb-99db-21fda0f28aeb.png)

<br><br>

ê·¸ë˜ì„œ ê°œë°œì ë„êµ¬ë¡œ ì´ì „ ê¸€ê³¼ ë‹¤ìŒ ê¸€ë¡œ ë„˜ì–´ê°ˆ ë•Œ ì–´ë–¤ ê²ƒì´ ë°”ë€ŒëŠ”ì§€ í™•ì¸í•´ ë³¸ ê²°ê³¼, session storageì˜ ê°’ì„ ë³€ê²½í•´ê°€ë©´ì„œ í˜ì´ì§€ë¥¼ ë°”ê¾¸ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/42775225/95010165-1ee7c700-0662-11eb-9c03-423fa4ea6cac.png)

<br><br>

í•´ë‹¹ ì‚¬ì‹¤ì„ í™•ì¸í•˜ê³ ëŠ” seleniumìœ¼ë¡œ session storage ê°’ì„ ë³€ê²½í•´ê°€ë©´ì„œ ë°ì´í„° ìˆ˜ì§‘ì„ ì™„ë£Œí•˜ì˜€ìŠµë‹ˆë‹¤.

âœ… ìµœì¢… ê²°ê³¼

![image](https://user-images.githubusercontent.com/42775225/95010227-8d2c8980-0662-11eb-81b5-8565fed38ef9.png)

êµìˆ˜ë‹˜ê»˜ì„œ 1ì›” ë‹¬ë¶€í„° ë°ì´í„°ë¥¼ ìš”êµ¬í•˜ì…”ì„œ ì•½ 35000rowê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤. (utf-8, cp949, euc-kr ì„¸ ê°€ì§€ ì¸ì½”ë”© ë°©ì‹ìœ¼ë¡œ ë„˜ê²¨ë“œë ¸ìŠµë‹ˆë‹¤.)

<br><br>

# ì´ë²ˆ í•™ê¸°ê°€ ëë‚˜ë©´

ì–´ë–¤ ê³³ì—ì„œ ì–´ë–¤ ì¼ì„ í•˜ê²Œ ë ì§€ ê¶ê¸ˆí•˜ê¸°ë„ í•˜ê³ , ê¸°ëŒ€ê°€ ë˜ê¸°ë„ í•©ë‹ˆë‹¤. ê³ ë“±í•™êµ ë•Œ ëŒ€í•™ì„ ê¸°ëŒ€í•˜ëŠ” ê²ƒê³¼ëŠ” ë˜ ë‹¤ë¥¸! ë§ˆìŒì´ë„ê¹Œ,,

ìµœì„ ì„ ë‹¤í•˜ëŠ” ë§ˆì§€ë§‰ í•™ê¸°ë¥¼ ë³´ë‚´ê² ìŠµë‹ˆë‹¤~~~~ ë°”ì˜ë‹¤ê³  ì£¼ë³€ì˜ ì†Œì¤‘í•œ ì‚¬ëŒë“¤ì—ê²Œ ì†Œí™€í•˜ì§€ ì•Šê¸°ë¥¼ ğŸ¤—

<br><br>

# ì‚¬ìš©í–ˆë˜ ì½”ë“œë“¤!

1. ì´ë²ˆ í¬ë¡¤ë§ì—ì„œ ì‚¬ìš©í–ˆë˜ ëª¨ë“ˆì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. seleniumì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” í¬ë¡¬ ë“œë¼ì´ë²„ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤. (ë³¸ì¸ì´ ì‚¬ìš©í•˜ëŠ” í¬ë¡¬ ë¸Œë¼ìš°ì €ì˜ ë²„ì „ê³¼ ë™ì¼í•œ ë²„ì „ìœ¼ë¡œ ë‹¤ìš´ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.)

   cf) í¬ë¡¬ ë“œë¼ì´ë²„ ì„¤ì¹˜ ë§í¬ : https://chromedriver.chromium.org/downloads

   ![image](https://user-images.githubusercontent.com/42775225/95010534-0200c300-0665-11eb-9085-064827124f22.png)

   ```python
   from selenium import webdriver
   import pandas as pd
   import re
   import time
   import random
   from selenium.webdriver.common.by import By
   ```

2. ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì˜ ê°’ì„ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì•„ë˜ì˜ window.~~ ì½”ë“œê°€ í•´ë‹¹ ì½”ë“œì…ë‹ˆë‹¤. ìš°ì„  ë“œë¼ì´ë²„ë¡œ ë¸Œë¼ìš°ì €ë¥¼ ì—½ë‹ˆë‹¤.

   ```python
   class SessionStorage:
       def __init__(self, driver) :
           self.driver = driver
       def set(self, key, value):
           self.driver.execute_script("window.sessionStorage.setItem(arguments[0], arguments[1]);", key, value)
       def __setitem__(self, key, value):
           self.set(key, value)

   driver = webdriver.Chrome('/Users/osangjin/Desktop/dev/Algo/chromedriver')
   url = 'http://www.safekorea.go.kr/idsiSFK/neo/sfk/cs/sfc/dis/disasterMsgView.jsp?menuSeq=679'
   driver.get(url)
   ```

3. ê·¸ ë‹¤ìŒ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ ê°’ì„ ë³€ê²½í•˜ê³ , ìƒˆë¡œê³ ì¹¨ í•˜ë©´ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì™”ìŠµë‹ˆë‹¤. (textê°€ ì•„ì˜ˆ ì—†ëŠ” ê²½ìš°ë„ ìˆì–´ì„œ try, exceptë¡œ ì²˜ë¦¬í•´ì¤ë‹ˆë‹¤.) ì‹œê°„ì´ ì—„ì²­ ë§ì´ ê±¸ë¦½ë‹ˆë‹¤..

   ```python
   for i in range(START, END):
       storage["bbs_ordr"] = i
       driver.execute_script("window.location.reload();")
       time.sleep(random.random()+0.3)

       search_result = driver.find_element(By.ID, 'sj')
       txt = search_result.text

       p = re.compile('(\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2})')
       try:
           date = re.findall(p, txt)[0]
       except:
           date = ''

       search_result = driver.find_element(By.ID, 'cn')
       txt = search_result.text

       try:
           content = txt[txt.index('['):txt.index('-ì†¡ì¶œì§€ì—­-')]
       except:
           content = ''

       p = re.compile('\-ì†¡ì¶œì§€ì—­\-\n(.*)')
       try:
           start_char = re.findall(p, txt)[0]
           broadcast = txt[txt.index(start_char):]
       except:
           broadcast = ''
       data_lst[idx] = [date, content, broadcast]
       idx+=1
       print("{}ë²ˆì§¸ ì™„ë£Œ!".format(i))
   ```

4. pandasë¡œ csvíŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

   ```python
   df = pd.DataFrame(data_lst,columns=['ì‹œê°„', 'ë‚´ìš©', 'ì†¡ì¶œì§€ì—­'])
   df.to_csv("utf.csv", encoding='utf-8')
   df.to_csv("cp.csv", encoding='cp949')
   df.to_csv("euc.csv", encoding='euc-kr')

   driver.close()
   ```

5. í„°ë¯¸ë„ì„ ì—¬ëŸ¬ê°œ ì¼œì„œ ë³‘ë ¬ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì–»ìŠµë‹ˆë‹¤.
   ![image](https://user-images.githubusercontent.com/42775225/95010683-4345a280-0666-11eb-9a69-f037ca4b23e1.png)
