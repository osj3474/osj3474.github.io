---
title: \[Web\] ìŠ¤í”„ë§ë¶€íŠ¸ Redis ì‚¬ìš©ë²• - (ì„¸íŒ…í¸)
excerpt: "ì¸í”„ë¼ë¡œ ë°±ì—”ë“œ ì´ìŠˆë¥¼ í•´ê²°í•˜ëŠ” ì‹¤ì œ ì ìš© ì¼€ì´ìŠ¤"
categories:
   - web
---

<br /><br />

# 1. redis ì„¤ì¹˜ ğŸ¯

<hr />

redisë¥¼ ì„¤ì¹˜í•  ì„œë²„ë¥¼ ê²°ì •í–ˆë‹¤ë©´ í•´ë‹¹ ì„œë²„ë¡œ ê°€ì„œ ì„¤ì¹˜ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

<b>ì„¤ì¹˜</b>

```shell
apt-get install redis-server
```

<br />

<b>ì„¤ì • ì„¸íŒ…</b>

```shell
vim /etc/redis/redis.conf
```

<br />

<b>redis.conf íŒŒì¼ ìˆ˜ì •</b>

```conf
# bind 127.0.0.1 ::1
bind 0.0.0.0 ::1

# requirepass foobared
requirepass sangjinRedis
```

<br />

<b>Redis ì¬ì‹œì‘</b>

```shell
systemctl restart redis-server
```

<br />

<b>Redis ìƒíƒœë³´ê¸°</b>

```shell
systemctl status redis-server
```

<br />

<b>6379 í¬íŠ¸ ì˜¤í”ˆ</b>

```shell
sudo iptables -I INPUT 5 -i ens3 -p tcp --dport 6379 -m state --state NEW,ESTABLISHED -j ACCEPT
```

<br /><br /><br />

# 2. GUIíˆ´ ì„¤ì¹˜ ğŸ¯

<hr />

### < Mac íˆ´ >

: medisê°€ ëŒ€í‘œì ì¸ íˆ´ì¸ë°, ë¬´ë£Œì¸ medis 2ì˜ ê²½ìš°ì—ëŠ” ì—°ê²° í•˜ë‚˜ ë°–ì— ì•ˆë©ë‹ˆë‹¤ ã… ã…œ...

![image](https://user-images.githubusercontent.com/42775225/190624281-6709e694-09d1-46e6-af7e-652fc47b6a0f.png)

<br />

ì„œë²„ì— ì ‘ì†í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

new serverì„ í´ë¦­í•´ì„œ, hostì™€ passwordë¥¼ ì…ë ¥í•´ì¤ë‹ˆë‹¤.

- host : redisë¥¼ ì„¤ì¹˜í•œ ì„œë²„ì˜ ip
- password : redis.conf ì—ì„œ `requirepass` ë‹¤ìŒì— ì…ë ¥í–ˆë˜ ê°’

![image](https://user-images.githubusercontent.com/42775225/190624624-70de23d8-2d6e-48e3-99ad-84bc6172b926.png)

![image](https://user-images.githubusercontent.com/42775225/190624879-d347ad49-0941-42e8-aa96-86b492d2e4c2.png)


<hr />

### < Windows íˆ´ >

: p3xë„ ìˆê³ , redis desktop managerë„ ìˆëŠ”ë°, ì €ëŠ” p3xë¥¼ ì„ íƒí•´ë³´ì•˜ìŠµë‹ˆë‹¤.

p3xëŠ” ë¬´ë£Œì´ê³ , ì•„ë˜ ë§í¬ì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.

=> <a href="https://www.electronjs.org/apps/p3x-redis-ui" target="_blank">https://www.electronjs.org/apps/p3x-redis-ui</a>

<img width="963" alt="image" src="https://user-images.githubusercontent.com/42775225/190623150-631df8ff-78b1-4d53-838b-f08bb6fa2999.png">

(redis desktop managerëŠ” ìœ ë£Œë¼ì„œ, ì‚¬ìš©í•˜ë ¤ë©´ ë¬´ë£Œ ë²„ì „ ì„¤ì¹˜ íŒŒì¼ì„ ì°¾ì•„ì„œ ë‹¤ìš´ë¡œë“œ í•´ì•¼í•©ë‹ˆë‹¤.)


<br />

ì„œë²„ì— ì ‘ì†í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

=> settings > new connection > ì •ë³´ ì…ë ¥ > Test connection > add

<img width="1389" alt="image" src="https://user-images.githubusercontent.com/42775225/190623438-fb3ad5cc-e0b9-4b2a-b3dd-a26d522a5d3a.png">


<br />

ê·¸ë¦¬ê³ ëŠ” Home ì„ ëˆŒëŸ¬ì„œ ë°ì´í„°ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

<img width="1415" alt="image" src="https://user-images.githubusercontent.com/42775225/190623598-a0c7a970-5491-40df-bc11-802e4e2fde0d.png">


<hr />

<br /><br />

# 3. ìŠ¤í”„ë§ ë¶€íŠ¸ í™˜ê²½ ì„¸íŒ… ğŸ¯

<hr />

ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ build.gradle ì„ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

<b>build.gradle</b>

```gradle
implementation 'org.springframework.boot:spring-boot-starter-data-redis'
```

<br />

ê·¸ë¦¬ê³  application.ymlì— ê°’ì„ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

<b>build.gradle</b>

```yml
spring:
  redis:
      host: redisì˜ ip
      port: 6379
      password: redis ë¹„ë°€ë²ˆí˜¸

  cache:
    type: redis
```

<br />

ê·¸ë¦¬ê³  config ì½”ë“œë¥¼ 2ê°€ì§€ ì¶”ê°€í•©ë‹ˆë‹¤.

<b>RedisCacheConfig.java</b>

```java
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.cache.RedisCacheConfiguration;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.RedisSerializationContext;
import org.springframework.data.redis.serializer.StringRedisSerializer;

import java.time.Duration;

@Configuration
@EnableCaching
public class RedisCacheConfig {

    @Bean
    public CacheManager userCacheManager(RedisConnectionFactory connectionFactory) {
        RedisCacheConfiguration redisCacheConfiguration = RedisCacheConfiguration.defaultCacheConfig()
                .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(new StringRedisSerializer()))
                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer()))
                .entryTtl(Duration.ofHours(3L));

        return RedisCacheManager.RedisCacheManagerBuilder.fromConnectionFactory(connectionFactory).cacheDefaults(redisCacheConfiguration).build();
    }
}
```

<b>RedisConfiguration.java</b>

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;

@Configuration
public class RedisConfiguration {

    @Bean
    public RedisTemplate<String, String> redisTemplate(LettuceConnectionFactory lettuceConnectionFactory) {
        RedisTemplate<String, String> redisTemplate = new RedisTemplate<>();
        redisTemplate.setConnectionFactory(lettuceConnectionFactory);
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        redisTemplate.setValueSerializer(new StringRedisSerializer());
        return redisTemplate;
    }

    @Bean
    public RedisTemplate<String, Object> redisTemplateObj(LettuceConnectionFactory lettuceConnectionFactory) {
        RedisTemplate<String, Object> redisTemplate = new RedisTemplate<>();
        redisTemplate.setConnectionFactory(lettuceConnectionFactory);
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        redisTemplate.setValueSerializer(new Jackson2JsonRedisSerializer<>(Object.class));
        return redisTemplate;
    }
}
```


<br /><br /><br />

# 4. ë§Œë‚ ì§€ë„ ëª¨ë¥´ëŠ” ì—ëŸ¬ë“¤ ğŸ¯

<hr />

<b>1) ìƒì„±ì ì´ìŠˆ</b>


redisì˜ ì§ë ¬í™” ë©”ì†Œë“œëŠ” ì—­ì§ë ¬í™” ê³¼ì •ì—ì„œ ê¸°ë³¸ ìƒì„±ìê°€ í•„ìš”í•˜ë©°, 

@Builder ì™€ í•¨ê»˜ ì“°ê³  ìˆë‹¤ë©´ @AllArgsConstructor ë„ ì¶”ê°€ê°€ í•„ìš”í•©ë‹ˆë‹¤.

<span style="font-size: 15px;">Exception : </span><span style="color: #a14550; font-size: 15px;">org.springframework.data.redis.serializer.SerializationException: Could not read JSON: Cannot construct instance of `[í´ë˜ìŠ¤ëª…]` (no Creators, like default constructor, exist): cannot deserialize from Object value (no delegate- or property-based Creator)</span>

<p>
   <span>í•´ê²°ë°©ë²•) </span>
</p>

```java
@NoArgsConstructor
@AllArgsConstructor
```

<br /><br />



<b>2) LocalDateTime ì´ìŠˆ</b> 

redisì— LocalDateTime íƒ€ì…ì„ ì—­ì§ë ¬í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì•„ë˜ Exception ì˜ˆì‹œì™€ í•´ê²° ë°©ë²•ì„ ë³´ê¸° ì „ì— build.gradleì— ëª¨ë“ˆì„ í•˜ë‚˜ ì¶”ê°€í•©ì‹œë‹¤.

```gradle
implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310'
```

<br />

<hr />

<span style="font-size: 15px;">Exception : </span><span style="color: #a14550; font-size: 15px;">org.springframework.data.redis.serializer.SerializationException: Could not write JSON: Java 8 date/time type `java.time.LocalDateTime` not supported by default</span>

<p>
   <span>í•´ê²°ë°©ë²•) </span>
</p>

```java
@JsonSerialize(using = LocalDateTimeSerializer.class)
```


<br />

<hr />

<span style="font-size: 15px;">Exception : </span><span style="color: #a14550; font-size: 15px;">org.springframework.data.redis.serializer.SerializationException: Could not read JSON: Java 8 date/time type `java.time.LocalDateTime` not supported by default</span>

<p>
   <span>í•´ê²°ë°©ë²•) </span>
</p>

```java
@JsonDeserialize(using = LocalDateTimeDeserializer.class)
```

<hr />

<br />



<br />

ì •ë§ ê³ ìƒ ë§ìœ¼ì…¨ìŠµë‹ˆë‹¤~!

ì´ì œ ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•´ì„œ redis ì ìš©ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤.

=> <a href="https://github.com/osj3474/redis3" target="_blank">ìŠ¤í”„ë§ë¶€íŠ¸ Redis ì‚¬ìš©ë²• - (ì ìš©í¸)</a>

<br /><br /><br />
